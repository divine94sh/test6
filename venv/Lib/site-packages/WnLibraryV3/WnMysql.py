import pymysql
from WnLibraryV3 import WnLog

path=WnLog.path


class WnMysql(object):
    ROBOT_LIBRARY_SCOPE = "GLOBAL"

    def wnmysql_get(self,host,port,username,password,db_name,sql,params=()):
        list_data = ()
        db=None
        cur=None
        try:
            db=pymysql.connect(host=host, port=int(port), user=username, password=password,
                                  db=db_name, charset='utf8')
            cur=db.cursor()
            cur.execute(sql, params)
            list_data = cur.fetchall()
            cur.close()
            db.close()
        except Exception as e:
            WnLog.wn_log(msg='#####wnmysql_get执行异常：{}'.format(e), level="ERROR", console=1, save_log=1, log_path=path)
        return list_data





if __name__ == '__main__':
    wnMysql = WnMysql()
    print(wnMysql.wnmysql_get(host,int(port),username,password,'pharmacy_org', 'SELECT * from pharmacy_dept where dept_id=1'))
