import pymongo
from bson.objectid import ObjectId

class WnMongo(object):
    '''
    Mongo数据库访问库
    '''
    default_host = "172.16.6.93"

    def wn_mongo_insert(self, collectionName, data, host=default_host):
        cl = pymongo.MongoClient(host, 27017)
        db = cl["windba"]
        collection = db[collectionName]
        inserted_id = str(collection.insert_one(data).inserted_id)
        cl.close()
        return inserted_id

    def wn_mongo_query_by_id(self, collectionName, id, host=default_host):
        ''':param id 数据项id属性'''
        cl = pymongo.MongoClient(host, 27017)
        db = cl["windba"]
        collection = db[collectionName]
        return collection.find_one({'_id': ObjectId(id)})

    def wn_mongo_query_by_variablesVersion(self, collectionName, variablesVersion, host=default_host):
        ''':param env 数据项env属性'''
        cl = pymongo.MongoClient(host, 27017)
        db = cl["windba"]
        collection = db[collectionName]
        return collection.find_one({'variablesVersion': variablesVersion})

    def wn_mongo_remove(self, collectionName, host=default_host):
        cl = pymongo.MongoClient(host, 27017)
        db = cl["windba"]
        collection = db[collectionName]
        collection.remove()
        cl.close()



















