import rsa
import base64
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_v1_5 as Cipher_pkcs1_v1_5
from WnLibraryV3 import WnLog

class WnRsa():


    ROBOT_LIBRARY_SCOPE = "GLOBAL"

    public_key = '-----BEGIN PRIVATE KEY-----\n'+'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDFga/9K2wRk7KySiKGOGk8/OitHfQFD1f+8Zd60XIBmrgTMRHHwLe7bROjFvFclmcYTHunp/HRwrQjBD2CeDwa1CGDVQHriI+HOiddVeSn/xqszjr4giuaD9ATpNmS5GY+sMC+5EygevawdEjQvFGb9mRBApiUExTlhkleHGwoWQIDAQAB'+'\n-----END PRIVATE KEY-----'

    def wnrsa_pswd_encrypt(self,pswd):
        try:
            rsakey = RSA.importKey(self.public_key.encode())
            cipher = Cipher_pkcs1_v1_5.new(rsakey)  # 创建用于执行pkcs1_v1_5加密或解密的密码
            cipher_text = base64.b64encode(cipher.encrypt(pswd.encode('utf-8')))
            return cipher_text.decode('utf-8')
        except Exception as e:
            WnLog.wn_log(msg='#####wnrsa_pswd_encrypt 密码：{}加密失败'.format(pswd), level="ERROR", console=1,save_log=1, log_path=WnLog.path)





if __name__ == '__main__':
    wnrsa=WnRsa()
    print(wnrsa.wnrsa_pswd_encrypt('Admin001.'))
