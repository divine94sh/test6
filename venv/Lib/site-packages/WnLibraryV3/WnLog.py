import time
import os
from robot.api import logger
import sys

'''
日志打印
'''


class WnLog(object):

    ROBOT_LIBRARY_SCOPE = "GLOBAL"

    # path = 'd:\\rf_log.log'
    # disk =os.path.abspath('.')[:2]
    path= os.getcwd()+os.sep+'rf_log.log'
    # inPutPath=os.path.abspath(sys.argv[0])
    # path = os.path.dirname(inPutPath)+os.sep+'rf_log.log'

    def wn_log(msg='log', level='info', console=0, save_log=1, log_path=path):
        """
        调用robot logger打印日志并保存到本地文件
        """
        if level not in ['info', 'ERROR', 'WARN']:
            raise Exception('level must in [info,ERROR,WARN]')
        msg_unicode = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime())+str(msg)
        if level == 'info':
            logger.write(msg_unicode, level='INFO')
            if int(console) == 1:
                logger.console(msg_unicode, stream='INFO')
        else:
            logger.console('')
            time.sleep(0.01)
            logger.write(msg_unicode, level=level)
        '''
        是否保存log到本地
        '''
        if save_log == 1:
            with open(log_path, 'a') as f:
                if level == 'info':
                    f.write(msg_unicode + '\n')
                else:
                    f.write('[' + level + ']' + msg_unicode + '\n')


if __name__ == "__main__":
    WnLog.wn_log(msg="Wnlog", level="info", console=0, save_log=1)
    # WnLog.wn_log(msg="Wnlog", level="ERROR", console=0, save_log=1, log_path=WnLog.path)
    print (WnLog.path)
