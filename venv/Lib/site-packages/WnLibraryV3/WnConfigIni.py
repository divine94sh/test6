import configparser
from WnLibraryV3 import WnLog

path=WnLog.path
class WnConfigIni(object):

    ROBOT_LIBRARY_SCOPE = "GLOBAL"

    def wnconfigini_get(self,fileName,section,key):
        try:
            config = configparser.ConfigParser()
            config.read(fileName)
            return config[section][key]
        except:
            WnLog.wn_log(msg='#####wnconfigini_get配置文件读取{}.{}失败'.format(section,key), level="ERROR", console=1, save_log=1, log_path=path)

    def wnconfigini_get_all(self,fileName):
        config_value={}
        try:
            config = configparser.ConfigParser()
            config.read(fileName)
            sections=config.sections()
            for s in sections:
                config_value[s] = {}
                options= config.options(s)
                for opt in options:
                    config_value[s][opt]= config[s][opt]
            return config_value
        except:
            WnLog.wn_log(msg='#####wnconfigini_get_all配置文件读取失败', level="ERROR", console=1, save_log=1, log_path=path)



    # def wnconfigini_config_path(self):
    #     try:
    #         data=path.split('用例层')
    #         if len(data):
    #             config_url= data[0]+'1操作层\\config.ini'
    #             if config_url!='':
    #                 WnLog.wn_log(msg='#####wnconfigini_config_path获取文件路径成功：{}'.format(config_url), level="info", console=1, save_log=1,log_path=path)
    #             return config_url
    #     except:
    #         WnLog.wn_log(msg='#####wnconfigini_config_path配置文件路径返回失败', level="ERROR", console=1,save_log=1, log_path=path)

    def wnconfigini_config_path(self):
        try:
            data=path.split('test2')
            if len(data):
                config_url= data[0]+'\\test2\WnTest\\1操作层\config.ini'
                if config_url!='':
                    WnLog.wn_log(msg='#####wnconfigini_config_path获取文件路径成功：{}'.format(config_url), level="info", console=1, save_log=1,log_path=path)
                return config_url
        except:
            WnLog.wn_log(msg='#####wnconfigini_config_path配置文件路径返回失败', level="ERROR", console=1,save_log=1, log_path=path)


if __name__ == '__main__':
    wnConfigIni=WnConfigIni()
    print(wnConfigIni.wnconfigini_get_all('E:\\ysq_robot\\WnTest\\1操作层\\config.ini'))