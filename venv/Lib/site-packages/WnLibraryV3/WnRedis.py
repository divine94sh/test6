import redis
from WnLibraryV3 import WnLog


class WnRedis():

    ROBOT_LIBRARY_SCOPE = "GLOBAL"


    def wnredis_get(self,ip,port,password,key):
        try:
            pool= redis.ConnectionPool(host=ip,port=port,password=password,db=24,decode_responses=True)
            r=redis.Redis(connection_pool=pool)
            value=r.get(key)
            if value:
                WnLog.wn_log(msg='#####wnredis_get获取验证码成功：{}'.format(value), level="info", console=0, save_log=1,log_path=WnLog.path)
                return value
            else:
                WnLog.wn_log(msg='#####wnredis_get key:{}取值失败'.format(key), level="ERROR", console=1, save_log=1, log_path=WnLog.path)
        except Exception as e:
            WnLog.wn_log(msg='#####wnredis_get {}:{} 密码：{}连接失败'.format(ip,port,password), level="ERROR", console=1, save_log=1,log_path=WnLog.path)


if __name__ == "__main__":
    wnRedis = WnRedis()
    print(wnRedis.wnredis_get ('121.196.188.16','6379','b$vmI8mA','c3d6ee0a-d33d-49f3-9d06-eb277dd2e90f'))

